<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>MOIRA - Firmware Updater</title> <!-- Thymos - Moira Firmware Flasher (ESP32-S3) -->


    <script>
        // Clear console - Fresh start
        console.clear();
        console.info(`%c\n\nMoira Updater - Thymos\n`, "color: #007bff; font-size: 20px; font-weight: bold;");
        console.info(`%c\n\nApp initialization: ${(new Date().toLocaleString()).replaceAll(". ", ".")}\n`, "color: gray; font-size: 12px; font-weight: normal;");


        fetch("../shared-header.html")
            .then(res => res.text())
            .then(html => document.head.insertAdjacentHTML("beforeend", html));
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        button {
            margin: 5px;
            padding: 10px;
        }

        input[type="file"] {
            margin: 5px 5px 5px 15px;
            border: 3px solid gray;
            padding: 4px;
            width: 400px;
        }

        #form-group {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
        }

        .fileInput {
            margin-left: 30px;
        }

        #connectionStatus {
            font-weight: bold;
            color: gray;
        }

        #logOutput {
            width: 95%;
            height: 300px;
            font-family: monospace;
            font-size: 16px;
            text-align: left;
            overflow-y: scroll;
            border: 1px solid #ccc;
            padding: 10px;
            justify-self: center;


        }

        #connectButton {
            font-weight: bold;
            color: gray;
            background-color: whitesmoke;
        }

        .disabled, .disabled * {
            cursor: not-allowed; /* ZmÄ›nÃ­ kurzor na not-allowed */
            -webkit-user-select: none; /* Pro starÅ¡Ã­ verze prohlÃ­Å¾eÄÅ¯ */
            user-select: none; /* ZabrÃ¡nÃ­ oznaÄovÃ¡nÃ­ textu */
            pointer-events: none; /* ZamezÃ­ klikÃ¡nÃ­, hover efektÅ¯m a interakci */
            tab-index: -1;
        }

        .disabled {
            opacity: 0.8; /* ZtmavenÃ­ pro vizuÃ¡lnÃ­ indikaci deaktivace */
        }

        .section {
            margin-bottom: 4em;
        }

    </style>

    <script src="pako.min.js" defer></script> <!-- TODO: use default compression from browser API if available and have 'pako' as fallback -->

</head>
<body>

<main>
    <section class="section">
        <h1>ğŸ’½ MOIRA Firmware Updater - THYMOS devices</h1> <!--  (ESP32-S3) -->
    </section>

    <section class="section">
        <h3>ğŸ  Navigation:</h3>
        <button id="returnButton" class="actionUI">ğŸ”™ Return back to Moira Control Panel</button>
    </section>


    <section class="section">
        <h2>ğŸ”§ Connection:</h2>
        <button id="connectButton" class="actionUI">ğŸ”‘ Connect to ESP32-S3</button>
        <br><br>
        <label for="connectionStatus" class="fileInput">ğŸ’¡ Status:</label>
        <span id="connectionStatus">ğŸ”’ Not connected</span>
    </section>

    <section class="section disabled">
        <h2>ğŸ—ƒï¸ Files:</h2>
        <button id="selectFolderButton" class="actionUI" disabled>ğŸ“‚ Select Folder with Firmware Files</button>
        <button id="clearFilesBtn" class="actionUI" disabled>ğŸ§¹ Clear All Files</button>


        <div id="form-group" class="actionUI">
            <label for="bootloaderFile" class="fileInput" disabled>ğŸ·ï¸ Bootloader:</label>
            <input type="file" id="bootloaderFile" accept=".ino.bootloader.bin" disabled>

            <label for="partitionsFile" class="fileInput" disabled>ğŸ“š Partitions:</label>
            <input type="file" id="partitionsFile" accept=".ino.partitions.bin" disabled>

            <label for="firmwareFile" class="fileInput" disabled>ğŸ› ï¸ Firmware:</label>
            <input type="file" id="firmwareFile" accept=".ino.bin" disabled>
        </div>
    </section>

    <section class="section">
        <h2>ğŸ§° Process:</h2>
        <button id="flashButton" class="actionUI">âš¡ Update Firmware</button>
    </section>

    <section class="section">
        <h2>ğŸ“ Outputs:</h2>
        <label class="fileInput">ğŸ“‘ Log:</label>
        <pre id="logOutput"></pre>
    </section>
</main>


<script type="module" src="app.js" defer></script>

</body>
</html>
